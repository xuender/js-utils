/*! js-utils 2013-06-13 */
var arrayRemove,findArray,getId,groupBy,isArray,localStorageGet,localStorageSet,sortOn,updateArray;getId=function(a){return null==a&&(a="ID"),void 0===window[a]&&(window[a]=1),window[a]++},isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},findArray=function(a,b,c){var d,e,f,g,h,i,j;if(isArray(c)){for(f=[],g=0,i=c.length;i>g;g++)e=c[g],f.push(findArray(a,b,e));return f}for(h=0,j=a.length;j>h;h++)if(d=a[h],d[b]===c)return d;return null},updateArray=function(a,b,c){var d,e;for(d in a)e=a[d],e===b&&(a[d]=c);return a},arrayRemove=function(a,b){var c,d,e;e=[];for(c in a)d=a[c],d===b&&e.push(a.splice(c,1));return e},sortOn=function(a,b){var c;return"-"===b[0]&&(c=!0,b=b.slice(1)),a.sort(function(a,c){return a[b]<=c[b]?-1:1}),c?a.reverse():void 0},groupBy=function(a,b){var c,d,e,f,g,h;for(f=[],sortOn(a,b),d="_INVALID_GROUP_VALUE_",g=0,h=a.length;h>g;g++)e=a[g],e[b]!==d&&(c={label:e[b],items:[]},d=c.label,f.push(c)),c.items.push(e);return f},localStorageGet=function(a,b){var c;return null==b&&(b=!1),c=localStorage.getItem(a),c?JSON.parse(c):b},localStorageSet=function(a,b){return localStorage.setItem(a,JSON.stringify(b))};var syncFetch,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};syncFetch=function(a,b){var c;c=new XMLHttpRequest,c.open("GET",chrome.extension.getURL(a),!1),c.onreadystatechange=function(){return 4===this.readyState&&""!==this.responseText?b(this.responseText):void 0};try{return c.send()}catch(d){}},chrome.i18n=function(){var a;return a=function(b,c){var d,e,f,g,h,i,j,k,l,m,n;if(void 0===b.placeholders&&void 0===c)return b.message.replace(/\$\$/g,"$");for(k=function(a,b,c){var d,e,f,g;return d=/\$\$/g,e="~~~I18N~~:",a=a.replace(d,e),a=a.replace(b,c),f=/~~~I18N~~:/g,g="$$$$",a.replace(f,g)},d=/\$([1-9])/g,e=function(a,b){return c[b-1]},j={},n=b.placeholders,l=0,m=n.length;m>l;l++)i=n[l],f=b.placeholders[i].content,j[i.toLowerCase()]=k(f,d,e);return h=k(b.message,d,e),h=k(h,/\$(\w+?)\$/g,function(a,b){var c;return c=b.toLowerCase(),__indexOf.call(j,c)>=0?j[c]:a}),h.replace(/\$\$/g,"$"),g=void 0,{_getL10nData:function(){var a,b,c,d,e,f;for(c={locales:[]},c.locales.push(navigator.language.replace("-","_")),navigator.language.length>2&&c.locales.push(navigator.language.substring(0,2)),-1===c.locales.indexOf("en")&&c.locales.push("en"),c.messages={},f=c.locales,d=0,e=f.length;e>d;d++)b=f[d],a="_locales/"+b+"/messages.json",syncFetch(a,function(a){return c.messages[b]=JSON.parse(a)});return c},_setL10nData:function(a){return g=a},getMessage:function(b,c){var d,e,f,h,i;for(void 0===g&&chrome.i18n._setL10nData(chrome.i18n._getL10nData()),"string"==typeof c&&(c=[c]),i=g.locales,f=0,h=i.length;h>f;f++)if(d=i[f],e=g.messages[d],e&&__indexOf.call(e,b)>=0)return a(e[b],c);return""}}}}();